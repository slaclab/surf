##############################################################################
## This file is part of 'SLAC Firmware Standard Library'.
## It is subject to the license terms in the LICENSE.txt file found in the 
## top-level directory of this distribution and at: 
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html. 
## No part of 'SLAC Firmware Standard Library', including this file, 
## may be copied, modified, propagated, or distributed except according to 
## the terms contained in the LICENSE.txt file.
##############################################################################

Device: &Adc16Dx370 
  name: Adc16Dx370
  description: ADC16Dx370 Module
  size: 0x200
  #########
  IntField:
  #########
    #########################################################
    - offset: 0x000
      name: AdcReg
      sizeBits: 8
      stride: 4
      nelms: 114
      mode: RW
      description: ADC Registers[113:0]           
    #########################################################
    - offset: 0x00C
      name: ID_DEVICE_TYPE
      sizeBits: 8
      mode: RO
      description: ID_DEVICE_TYPE 
    #########################################################
    - offset: 0x010
      name: ID_PROD_UPPER
      sizeBits: 8
      mode: RO
      description: ID_PROD_UPPER 
    #########################################################
    - offset: 0x014
      name: ID_PROD_LOWER
      sizeBits: 8
      mode: RO
      description: ID_PROD_LOWER 
    #########################################################
    - offset: 0x018
      name: ID_MASKREV
      sizeBits: 8
      mode: RO
      description: ID_MASKREV 
    #########################################################
    - offset: 0x030
      name: ID_VNDR_UPPER
      sizeBits: 8
      mode: RO
      description: ID_VNDR_UPPER     
    #########################################################
    - offset: 0x034
      name: ID_VNDR_LOWER
      sizeBits: 8
      mode: RO
      description: ID_VNDR_LOWER           
    #########################################################
    - offset: 0x1B0
      name: Clock_ready
      sizeBits: 1    
      lsBit: 0
      mode: RO
      description: Clock_ready      
    #########################################################
    - offset: 0x1B0
      name: Calibration_done
      sizeBits: 1    
      lsBit: 1
      mode: RO
      description: Calibration_done    
    #########################################################
    - offset: 0x1B0
      name: PLL_lock
      sizeBits: 1    
      lsBit: 2
      mode: RO
      description: PLL_lock     
    #########################################################
    - offset: 0x1B0
      name: Aligned_to_sysref
      sizeBits: 1    
      lsBit: 3
      mode: RO
      description: Aligned_to_sysref 
    #########################################################
    - offset: 0x1B0
      name: Realigned_to_sysref
      sizeBits: 1    
      lsBit: 4
      mode: RO
      description: Realigned_to_sysref    
    #########################################################
    - offset: 0x1B0
      name: Sync_form_FPGA
      sizeBits: 1    
      lsBit: 5
      mode: RO
      description: Sync_form_FPGA    
    #########################################################
    - offset: 0x1B0
      name: Link_active
      sizeBits: 1    
      lsBit: 6
      mode: RO
      description: Link_active          
    #########################################################
  #########
  Commands:
  #########
    #########################################################
    - name: PowerDown
      sequence:
        - ScalVal: AdcReg[2]
          SetVal: 0x3
    #########################################################
    - name: PowerUp
      sequence:
        - ScalVal: AdcReg[2]
          SetVal: 0x0          
    #########################################################
    - name: CalibrateAdc
      sequence:
        # Power Down
        - command: PowerDown
        # 1000 ms sleep
        - command: usleep
          set: 1000000 
        # Power Up
        - command: PowerUp
    #########################################################
    