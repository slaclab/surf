##############################################################################
## This file is part of 'SLAC Firmware Standard Library'.
## It is subject to the license terms in the LICENSE.txt file found in the 
## top-level directory of this distribution and at: 
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html. 
## No part of 'SLAC Firmware Standard Library', including this file, 
## may be copied, modified, propagated, or distributed except according to 
## the terms contained in the LICENSE.txt file.
##############################################################################

Device: &Lmk04828 
  name: Lmk04828
  description: LMK04828 Module
  size: 0x800
  #########
  IntField:
  #########
    #########################################################
    - offset: 0x400
      name: LmkReg_0x0100
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x404
      name: LmkReg_0x0101
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x408
      name: LmkReg_0x0102
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x40C
      name: LmkReg_0x0103
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x410
      name: LmkReg_0x0104
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x414
      name: LmkReg_0x0105
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x418
      name: LmkReg_0x0106
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x41C
      name: LmkReg_0x0107
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x420
      name: LmkReg_0x0108
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x424
      name: LmkReg_0x0109
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x428
      name: LmkReg_0x010A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x42C
      name: LmkReg_0x010B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x430
      name: LmkReg_0x010C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x434
      name: LmkReg_0x010D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x438
      name: LmkReg_0x010E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x43C
      name: LmkReg_0x010F
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################    
    #########################################################
    - offset: 0x440
      name: LmkReg_0x0110
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x444
      name: LmkReg_0x0111
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x448
      name: LmkReg_0x0112
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x44C
      name: LmkReg_0x0113
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x450
      name: LmkReg_0x0114
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x454
      name: LmkReg_0x0115
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x458
      name: LmkReg_0x0116
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x45C
      name: LmkReg_0x0117
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x460
      name: LmkReg_0x0118
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x464
      name: LmkReg_0x0119
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x468
      name: LmkReg_0x011A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x46C
      name: LmkReg_0x011B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x470
      name: LmkReg_0x011C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x474
      name: LmkReg_0x011D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x478
      name: LmkReg_0x011E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x47C
      name: LmkReg_0x011F
      sizeBits: 8
      mode: RW
      description: LMK Registers   
    #########################################################      
    #########################################################
    - offset: 0x480
      name: LmkReg_0x0120
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x484
      name: LmkReg_0x0121
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x488
      name: LmkReg_0x0122
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x48C
      name: LmkReg_0x0123
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x490
      name: LmkReg_0x0124
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x494
      name: LmkReg_0x0125
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x498
      name: LmkReg_0x0126
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x49C
      name: LmkReg_0x0127
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x4A0
      name: LmkReg_0x0128
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4A4
      name: LmkReg_0x0129
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4A8
      name: LmkReg_0x012A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4AC
      name: LmkReg_0x012B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4B0
      name: LmkReg_0x012C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4B4
      name: LmkReg_0x012D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4B8
      name: LmkReg_0x012E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4BC
      name: LmkReg_0x012F
      sizeBits: 8
      mode: RW
      description: LMK Registers   
    #########################################################       
    #########################################################
    - offset: 0x4C0
      name: LmkReg_0x0130
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4C4
      name: LmkReg_0x0131
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4C8
      name: LmkReg_0x0132
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4CC
      name: LmkReg_0x0133
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4D0
      name: LmkReg_0x0134
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4D4
      name: LmkReg_0x0135
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4D8
      name: LmkReg_0x0136
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4DC
      name: LmkReg_0x0137
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x4E0
      name: LmkReg_0x0138
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4E4
      name: LmkReg_0x0139
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4E8
      name: LmkReg_0x013A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4EC
      name: LmkReg_0x013B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4F0
      name: LmkReg_0x013C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4F4
      name: LmkReg_0x013D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x4F8
      name: LmkReg_0x013E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x4FC
      name: LmkReg_0x013F
      sizeBits: 8
      mode: RW
      description: LMK Registers   
    #########################################################      

    
    #########################################################
    - offset: 0x500
      name: LmkReg_0x0140
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x504
      name: LmkReg_0x0141
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x508
      name: LmkReg_0x0142
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x50C
      name: LmkReg_0x0143
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x510
      name: LmkReg_0x0144
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x514
      name: LmkReg_0x0145
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x518
      name: LmkReg_0x0146
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x51C
      name: LmkReg_0x0147
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x520
      name: LmkReg_0x0148
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x524
      name: LmkReg_0x0149
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x528
      name: LmkReg_0x014A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x52C
      name: LmkReg_0x014B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x530
      name: LmkReg_0x014C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x534
      name: LmkReg_0x014D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x538
      name: LmkReg_0x014E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x53C
      name: LmkReg_0x014F
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################    
    #########################################################
    - offset: 0x540
      name: LmkReg_0x0150
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x544
      name: LmkReg_0x0151
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x548
      name: LmkReg_0x0152
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x54C
      name: LmkReg_0x0153
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x550
      name: LmkReg_0x0154
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x554
      name: LmkReg_0x0155
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x558
      name: LmkReg_0x0156
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x55C
      name: LmkReg_0x0157
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x560
      name: LmkReg_0x0158
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x564
      name: LmkReg_0x0159
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x568
      name: LmkReg_0x015A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x56C
      name: LmkReg_0x015B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x570
      name: LmkReg_0x015C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x574
      name: LmkReg_0x015D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x578
      name: LmkReg_0x015E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x57C
      name: LmkReg_0x015F
      sizeBits: 8
      mode: RW
      description: LMK Registers   
    #########################################################      
    #########################################################
    - offset: 0x580
      name: LmkReg_0x0160
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x584
      name: LmkReg_0x0161
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x588
      name: LmkReg_0x0162
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x58C
      name: LmkReg_0x0163
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x590
      name: LmkReg_0x0164
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x594
      name: LmkReg_0x0165
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x598
      name: LmkReg_0x0166
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x59C
      name: LmkReg_0x0167
      sizeBits: 8
      mode: RW
      description: LMK Registers    
    #########################################################
    - offset: 0x5A0
      name: LmkReg_0x0168
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5A4
      name: LmkReg_0x0169
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5A8
      name: LmkReg_0x016A
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x5AC
      name: LmkReg_0x016B
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5B0
      name: LmkReg_0x016C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5B4
      name: LmkReg_0x016D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5B8
      name: LmkReg_0x016E
      sizeBits: 8
      mode: RW
      description: LMK Registers 
    #########################################################
    - offset: 0x5CC
      name: LmkReg_0x0173
      sizeBits: 8
      mode: RW
      description: LMK Registers   
    #########################################################
    - offset: 0x5D0
      name: LmkReg_0x0174
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5F0
      name: LmkReg_0x017C
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################
    - offset: 0x5F4
      name: LmkReg_0x017D
      sizeBits: 8
      mode: RW
      description: LMK Registers
    #########################################################       

    #########################################################
    #
    #   Status registers
    #
    ######################################################### 
    - offset: 0x00C
      name: ID_DEVICE_TYPE
      sizeBits: 8
      mode: RO
      description: ID_DEVICE_TYPE 
    #########################################################
    - offset: 0x010
      name: ID_PROD_UPPER
      sizeBits: 8
      mode: RO
      description: ID_PROD_UPPER 
    #########################################################
    - offset: 0x014
      name: ID_PROD_LOWER
      sizeBits: 8
      mode: RO
      description: ID_PROD_LOWER 
    #########################################################
    - offset: 0x018
      name: ID_MASKREV
      sizeBits: 8
      mode: RO
      description: ID_MASKREV 
    #########################################################
    - offset: 0x030
      name: ID_VNDR_UPPER
      sizeBits: 8
      mode: RO
      description: ID_VNDR_UPPER     
    #########################################################
    - offset: 0x034
      name: ID_VNDR_LOWER
      sizeBits: 8
      mode: RO
      description: ID_VNDR_LOWER
    #########################################################
    #
    #   Command support registers
    #
    #########################################################
    - offset: 0x4E4    
      name: EnableSysRef
      sizeBits: 2    
      lsBit: 0 
      mode: RW
      description: EnableSysRef 
    #########################################################
    - offset: 0x510    
      name: EnableSync
      sizeBits: 8 
      lsBit: 0 
      mode: RW
      description: EnableSync   
    #########################################################
    - offset: 0x50C
      name: SyncBit
      sizeBits: 1
      lsBit: 5 
      mode: RW
      description: SyncBit         
    #########################################################
  #########
  Commands:
  #########      
    #########################################################
    - name: InitLmk
      description: "Synchronise LMK internal counters. Warning this function will power off and power on all the system clocks"
      sequence:
        # Turn off normal continuous sysref
        - entry: EnableSysRef
          value: 0x0 
        # Turn On SYNC
        - entry: EnableSync
          value: 0x0           
        # 1000 ms sleep
        - entry: usleep
          value: 1000000 

        # Toggle Sync bit
        - entry: SyncBit
          value: 0x1    
        - entry: SyncBit
          value: 0x0        
        # 1000 ms sleep
        - entry: usleep
          value: 1000000           

        # Turn on normal continuous sysref
        - entry: EnableSysRef
          value: 0x3           
        # Turn Off SYNC
        - entry: EnableSync
          value: 0xff            
    #########################################################
    - name: PwrUpSysRef
      description: Powerup the sysref lines        
      sequence:
        # Turn on normal continuous sysref
        - entry: EnableSysRef
          value: 0x3
    #########################################################
    - name: PwrDwnSysRef
      description: Powerdown the sysref lines        
      sequence:
        # Turn off normal continuous sysref
        - entry: EnableSysRef
          value: 0x0          
    #########################################################
