##############################################################################
## This file is part of 'SLAC JESD204b Core'.
## It is subject to the license terms in the LICENSE.txt file found in the 
## top-level directory of this distribution and at: 
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html. 
## No part of 'SLAC JESD204b Core', including this file, 
## may be copied, modified, propagated, or distributed except according to 
## the terms contained in the LICENSE.txt file.
##############################################################################

Device: &JesdRx 
  name: JesdRx
  description: JESD RX Module
  size: 0x100
  #########
  IntField:
  #########
    #########################################################
    - offset: 0x00
      name: Enable
      sizeBits: 8
      mode: RW
      description: Enable[7:0]         
    ######################################################### 
    - offset: 0x04
      name: SysrefDelay
      sizeBits: 5
      mode: RW
      description: Sets the synchronisation delay in clock cycles      
    #########################################################    
    - offset: 0x10
      name: SubClass
      sizeBits: 1
      lsBit: 0      
      mode: RW
      description: SubClass  
    #########################################################  
    - offset: 0x10
      name: ReplaceEnable
      sizeBits: 1
      lsBit: 1      
      mode: RW
      description: ReplaceEnable  
    #########################################################  
    - offset: 0x10
      name: ResetGTs
      sizeBits: 1
      lsBit: 2 
      mode: RW
      description: ResetGTs  
    #########################################################    
    - offset: 0x10
      name: ClearErrors
      sizeBits: 1
      lsBit: 3 
      mode: RW
      description: ClearErrors  
    ######################################################### 
    - offset: 0x10
      name: InvertSync
      sizeBits: 1
      lsBit: 4
      mode: RW
      description: InvertSync  
    ######################################################### 
    - offset: 0x10
      name: ScrambleEnable
      sizeBits: 1
      lsBit: 5
      mode: RW
      description: ScrambleEnable  
    #########################################################        
    - offset: 0x040
      name: GTXReady
      sizeBits: 1    
      lsBit: 0
      stride: 4
      nelms: 8       
      mode: RO
      description: GTXReady[7:0]
    #########################################################        
    - offset: 0x040
      name: DataValid
      sizeBits: 1    
      lsBit: 1
      stride: 4
      nelms: 8       
      mode: RO
      description: DataValid[7:0]
    #########################################################        
    - offset: 0x040
      name: AlignErr
      sizeBits: 1    
      lsBit: 2
      stride: 4
      nelms: 8       
      mode: RO
      description: AlignErr[7:0]  
    #########################################################        
    - offset: 0x040
      name: nSync
      sizeBits: 1    
      lsBit: 3
      stride: 4
      nelms: 8       
      mode: RO
      description: nSync[7:0]  
    #########################################################        
    - offset: 0x040
      name: RxBuffUfl
      sizeBits: 1    
      lsBit: 4
      stride: 4
      nelms: 8       
      mode: RO
      description: RxBuffUfl[7:0]   
    #########################################################        
    - offset: 0x040
      name: RxBuffOfl
      sizeBits: 1    
      lsBit: 5
      stride: 4
      nelms: 8       
      mode: RO
      description: RxBuffOfl[7:0]  
    #########################################################        
    - offset: 0x040
      name: PositionErr
      sizeBits: 1    
      lsBit: 6
      stride: 4
      nelms: 8       
      mode: RO
      description: PositionErr[7:0]  
    #########################################################        
    - offset: 0x040
      name: RxEnabled
      sizeBits: 1    
      lsBit: 7
      stride: 4
      nelms: 8       
      mode: RO
      description: RxEnabled[7:0]     
    #########################################################        
    - offset: 0x041
      name: SysRefDetected
      sizeBits: 1    
      lsBit: 0
      stride: 4
      nelms: 8       
      mode: RO
      description: SysRefDetected[7:0]     
    #########################################################        
    - offset: 0x041
      name: CommaDetected
      sizeBits: 1    
      lsBit: 1
      stride: 4
      nelms: 8       
      mode: RO
      description: CommaDetected[7:0]  
    #########################################################        
    - offset: 0x041
      name: DisparityErr
      sizeBits: 4    
      lsBit: 2
      stride: 4
      nelms: 8       
      mode: RO
      description: DisparityErr[7:0]        
    #########################################################        
    - offset: 0x041
      name: DecErr
      sizeBits: 4    
      lsBit: 6
      stride: 4
      nelms: 8       
      mode: RO
      description: DecErr[7:0]  
    #########################################################        
    - offset: 0x042
      name: ElBuffLatency
      sizeBits: 4    
      lsBit: 2
      stride: 4
      nelms: 8       
      mode: RO
      description: ElBuffLatency[7:0]        
    #########################################################     
    - offset: 0xC0
      name: Threshold_Low
      sizeBits: 16
      stride: 4
      nelms: 8        
      mode: RW
      description: Threshold_Low[7:0] 
    #########################################################   
    - offset: 0xC2
      name: Threshold_High
      sizeBits: 16
      stride: 4
      nelms: 8        
      mode: RW
      description: Threshold_High[7:0] 
    #########################################################    
  #########
  Commands:
  #########
    #########################################################
    - name: ClearErrors
      description: Clear the registered errors of all RX lanes
      sequence:
        - entry: ClearErrors
          value: 0x1
        - entry: ClearErrors
          value: 0x0   
    #########################################################
    - name: ResetGTs
      description: Toggle the reset of all RX MGTs
      sequence:
        - entry: ResetGTs
          value: 0x1
        - entry: ResetGTs
          value: 0x0             
    #########################################################